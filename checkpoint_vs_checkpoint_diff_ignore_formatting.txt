--- ServerlessLLM/sllm_store/csrc/checkpoint/aligned_buffer.cpp	2025-11-11 10:30:03.292596773 +0000
+++ flashtensors/csrc/checkpoint/aligned_buffer.cpp	2025-11-11 10:30:03.764604624 +0000
@@ -1,20 +1,3 @@
-// ----------------------------------------------------------------------------
-//  ServerlessLLM
-//  Copyright (c) ServerlessLLM Team 2024
-//
-//   Licensed under the Apache License, Version 2.0 (the "License");
-//   you may not use this file except in compliance with the License.
-//
-//   You may obtain a copy of the License at
-//
-//                   http://www.apache.org/licenses/LICENSE-2.0
-//
-//   Unless required by applicable law or agreed to in writing, software
-//   distributed under the License is distributed on an "AS IS" BASIS,
-//   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-//   See the License for the specific language governing permissions and
-//   limitations under the License.
-//  ----------------------------------------------------------------------------
 #include "aligned_buffer.h"
 
 #include <fcntl.h>

--- ServerlessLLM/sllm_store/csrc/checkpoint/aligned_buffer.h	2025-11-11 10:30:03.293596790 +0000
+++ flashtensors/csrc/checkpoint/aligned_buffer.h	2025-11-11 10:30:03.764604624 +0000
@@ -1,20 +1,3 @@
-// ----------------------------------------------------------------------------
-//  ServerlessLLM
-//  Copyright (c) ServerlessLLM Team 2024
-//
-//   Licensed under the Apache License, Version 2.0 (the "License");
-//   you may not use this file except in compliance with the License.
-//
-//   You may obtain a copy of the License at
-//
-//                   http://www.apache.org/licenses/LICENSE-2.0
-//
-//   Unless required by applicable law or agreed to in writing, software
-//   distributed under the License is distributed on an "AS IS" BASIS,
-//   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-//   See the License for the specific language governing permissions and
-//   limitations under the License.
-//  ----------------------------------------------------------------------------
 #pragma once
 
 #include <string>

--- ServerlessLLM/sllm_store/csrc/checkpoint/checkpoint.cpp	2025-11-11 10:30:03.293596790 +0000
+++ flashtensors/csrc/checkpoint/checkpoint.cpp	2025-11-11 10:30:03.764604624 +0000
@@ -1,20 +1,3 @@
-// ----------------------------------------------------------------------------
-//  ServerlessLLM
-//  Copyright (c) ServerlessLLM Team 2024
-//
-//   Licensed under the Apache License, Version 2.0 (the "License");
-//   you may not use this file except in compliance with the License.
-//
-//   You may obtain a copy of the License at
-//
-//                   http://www.apache.org/licenses/LICENSE-2.0
-//
-//   Unless required by applicable law or agreed to in writing, software
-//   distributed under the License is distributed on an "AS IS" BASIS,
-//   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-//   See the License for the specific language governing permissions and
-//   limitations under the License.
-//  ----------------------------------------------------------------------------
 #include "checkpoint.h"
 
 #include <ATen/cuda/CUDABlas.h>
@@ -111,11 +94,12 @@
 
 std::unordered_map<std::string, torch::Tensor> RestoreTensors(
     const std::unordered_map<
-        std::string, std::tuple<std::vector<int64_t>, std::vector<int64_t>,
-                                std::string>>& meta_state_dict,
+        std::string,
+        std::tuple<std::vector<int64_t>, std::vector<int64_t>, std::string>>
+        &meta_state_dict,
     const std::unordered_map<int, void*>& memory_base_address,
-    const std::unordered_map<int, std::unordered_map<std::string, uint64_t>>&
-        tensor_device_offsets) {
+    const std::unordered_map<int, std::unordered_map<std::string, uint64_t>>
+        &tensor_device_offsets) {
   std::unordered_map<std::string, torch::Tensor> state_dict;
   std::unordered_set<void*> handled_memory;
   for (const auto& [device, tensor_offset] : tensor_device_offsets) {
@@ -142,7 +126,8 @@
           // device << std::endl;
         } else {
           torch::Tensor real_tensor = torch::from_blob(
-              reinterpret_cast<void*>(offset), sizes, strides, [](void* ptr) {},
+              reinterpret_cast<void *>(offset), sizes, strides,
+              [](void *ptr) {},
               torch::TensorOptions().device(tensor_device).dtype(dtype));
           state_dict[name] = real_tensor;
         }
@@ -187,8 +172,8 @@
   return uuidToDeviceIdMap;
 }
 
-std::unordered_map<int, void*> AllocateCudaMemory(
-    const std::unordered_map<int, size_t>& tensor_sizes) {
+std::unordered_map<int, void *>
+AllocateCudaMemory(const std::unordered_map<int, size_t> &tensor_sizes) {
   std::unordered_map<int, void*> memory_ptrs;
   for (const auto& p : tensor_sizes) {
     int device = p.first;
@@ -201,8 +186,8 @@
   return memory_ptrs;
 }
 
-std::unordered_map<int, std::string> GetCudaMemoryHandles(
-    const std::unordered_map<int, void*>& memory_ptrs) {
+std::unordered_map<int, std::string>
+GetCudaMemoryHandles(const std::unordered_map<int, void *> &memory_ptrs) {
   std::unordered_map<int, std::string> memory_handles;
   for (const auto& p : memory_ptrs) {
     int device = p.first;
@@ -210,8 +195,8 @@
     cudaIpcMemHandle_t handle;
     cudaSetDevice(device);
     cudaIpcGetMemHandle(&handle, ptr);
-    memory_handles[device] = std::string(reinterpret_cast<const char*>(&handle),
-                                         sizeof(cudaIpcMemHandle_t));
+    memory_handles[device] = std::string(
+        reinterpret_cast<const char *>(&handle), sizeof(cudaIpcMemHandle_t));
   }
   return memory_handles;
 }

--- ServerlessLLM/sllm_store/csrc/checkpoint/checkpoint.h	2025-11-11 10:30:03.293596790 +0000
+++ flashtensors/csrc/checkpoint/checkpoint.h	2025-11-11 10:30:03.764604624 +0000
@@ -1,20 +1,3 @@
-// ----------------------------------------------------------------------------
-//  ServerlessLLM
-//  Copyright (c) ServerlessLLM Team 2024
-//
-//   Licensed under the Apache License, Version 2.0 (the "License");
-//   you may not use this file except in compliance with the License.
-//
-//   You may obtain a copy of the License at
-//
-//                   http://www.apache.org/licenses/LICENSE-2.0
-//
-//   Unless required by applicable law or agreed to in writing, software
-//   distributed under the License is distributed on an "AS IS" BASIS,
-//   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-//   See the License for the specific language governing permissions and
-//   limitations under the License.
-//  ----------------------------------------------------------------------------
 #pragma once
 
 #include <torch/extension.h>
@@ -30,17 +13,18 @@
 
 std::unordered_map<std::string, torch::Tensor> RestoreTensors(
     const std::unordered_map<
-        std::string, std::tuple<std::vector<int64_t>, std::vector<int64_t>,
-                                std::string>>& meta_state_dict,
+        std::string,
+        std::tuple<std::vector<int64_t>, std::vector<int64_t>, std::string>>
+        &meta_state_dict,
     const std::unordered_map<int, void*>& memory_base_address,
-    const std::unordered_map<int, std::unordered_map<std::string, uint64_t>>&
-        tensor_device_offsets);
+    const std::unordered_map<int, std::unordered_map<std::string, uint64_t>>
+        &tensor_device_offsets);
 
 // {dev_id: ptr}
-std::unordered_map<int, void*> AllocateCudaMemory(
-    const std::unordered_map<int, size_t>& tensor_sizes);
-std::unordered_map<int, std::string> GetCudaMemoryHandles(
-    const std::unordered_map<int, void*>& memory_ptrs);
+std::unordered_map<int, void *>
+AllocateCudaMemory(const std::unordered_map<int, size_t> &tensor_sizes);
+std::unordered_map<int, std::string>
+GetCudaMemoryHandles(const std::unordered_map<int, void *> &memory_ptrs);
 std::unordered_map<int, std::vector<std::string>> GetCudaMemoryHandles(
     const std::unordered_map<int, std::vector<void*>>& memory_ptrs);
 std::unordered_map<int, std::string> GetDeviceUuidMap();

--- ServerlessLLM/sllm_store/csrc/checkpoint/checkpoint_py.cpp	2025-11-11 10:30:03.293596790 +0000
+++ flashtensors/csrc/checkpoint/checkpoint_py.cpp	2025-11-11 10:30:03.764604624 +0000
@@ -1,20 +1,3 @@
-// ----------------------------------------------------------------------------
-//  ServerlessLLM
-//  Copyright (c) ServerlessLLM Team 2024
-//
-//   Licensed under the Apache License, Version 2.0 (the "License");
-//   you may not use this file except in compliance with the License.
-//
-//   You may obtain a copy of the License at
-//
-//                   http://www.apache.org/licenses/LICENSE-2.0
-//
-//   Unless required by applicable law or agreed to in writing, software
-//   distributed under the License is distributed on an "AS IS" BASIS,
-//   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-//   See the License for the specific language governing permissions and
-//   limitations under the License.
-//  ----------------------------------------------------------------------------
 #include <torch/extension.h>
 
 #include "checkpoint.h"
@@ -57,8 +40,8 @@
           py::arg("memory_ptrs"), "Get cuda memory handles")
       .def(
           "get_cuda_memory_handles",
-          [](const std::unordered_map<int, std::vector<uint64_t>>&
-                 memory_ptrs) {
+          [](const std::unordered_map<int, std::vector<uint64_t>>
+                 &memory_ptrs) {
             std::unordered_map<int, std::vector<void*>> memory_ptrs_void;
             for (const auto& kv : memory_ptrs) {
               std::vector<void*> ptrs;

--- ServerlessLLM/sllm_store/csrc/checkpoint/progress_bar.h	2025-11-11 10:30:03.293596790 +0000
+++ flashtensors/csrc/checkpoint/progress_bar.h	2025-11-11 10:30:03.764604624 +0000
@@ -1,20 +1,3 @@
-// ----------------------------------------------------------------------------
-//  ServerlessLLM
-//  Copyright (c) ServerlessLLM Team 2024
-//
-//   Licensed under the Apache License, Version 2.0 (the "License");
-//   you may not use this file except in compliance with the License.
-//
-//   You may obtain a copy of the License at
-//
-//                   http://www.apache.org/licenses/LICENSE-2.0
-//
-//   Unless required by applicable law or agreed to in writing, software
-//   distributed under the License is distributed on an "AS IS" BASIS,
-//   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-//   See the License for the specific language governing permissions and
-//   limitations under the License.
-//  ----------------------------------------------------------------------------
 #include <iostream>
 
 void showProgressBar(float progress, std::string message = "") {

--- ServerlessLLM/sllm_store/csrc/checkpoint/tensor_writer.cpp	2025-11-11 10:30:03.293596790 +0000
+++ flashtensors/csrc/checkpoint/tensor_writer.cpp	2025-11-11 10:30:03.764604624 +0000
@@ -1,20 +1,3 @@
-// ----------------------------------------------------------------------------
-//  ServerlessLLM
-//  Copyright (c) ServerlessLLM Team 2024
-//
-//   Licensed under the Apache License, Version 2.0 (the "License");
-//   you may not use this file except in compliance with the License.
-//
-//   You may obtain a copy of the License at
-//
-//                   http://www.apache.org/licenses/LICENSE-2.0
-//
-//   Unless required by applicable law or agreed to in writing, software
-//   distributed under the License is distributed on an "AS IS" BASIS,
-//   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-//   See the License for the specific language governing permissions and
-//   limitations under the License.
-//  ----------------------------------------------------------------------------
 #include "tensor_writer.h"
 
 #include <iostream>

--- ServerlessLLM/sllm_store/csrc/checkpoint/tensor_writer.h	2025-11-11 10:30:03.293596790 +0000
+++ flashtensors/csrc/checkpoint/tensor_writer.h	2025-11-11 10:30:03.764604624 +0000
@@ -1,20 +1,3 @@
-// ----------------------------------------------------------------------------
-//  ServerlessLLM
-//  Copyright (c) ServerlessLLM Team 2024
-//
-//   Licensed under the Apache License, Version 2.0 (the "License");
-//   you may not use this file except in compliance with the License.
-//
-//   You may obtain a copy of the License at
-//
-//                   http://www.apache.org/licenses/LICENSE-2.0
-//
-//   Unless required by applicable law or agreed to in writing, software
-//   distributed under the License is distributed on an "AS IS" BASIS,
-//   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-//   See the License for the specific language governing permissions and
-//   limitations under the License.
-//  ----------------------------------------------------------------------------
 #pragma once
 
 #include <memory>

